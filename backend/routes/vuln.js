const express = require('express');
const { param, body, validationResult } = require('express-validator');
const path = require('path');
const { Vuln } = require(path.resolve(__dirname, '../utils/db'));
const router = express.Router();

/**
 * 获得所有漏洞列表
 */
router.get('/database', [], (req, res) => {
  Vuln.find().then(vulns => {
    // 获取成功
    res.json({ vulnDatabase: vulns });
  }).catch(err => {
    // 获取失败，其他错误
    res.status(500).json({ msg: '获取漏洞数据库信息出错' + err.message });
  });
});

module.exports = { router };
