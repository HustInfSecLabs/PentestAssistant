from wenxinAgent import planner
from wenxinAgent import refiner
import requests
p = planner()
r = refiner()

target = input("请输入整体目标（输入'quit'退出）: ")
plannow = p.query2bot(target)
headers = {
    'Content-Type': "application/json"
}
while True:
    # res = input("请输入目前步骤的结果（输入'quit'退出）: ")
    res = requests.post("http://localhost:8001/chat",json={"question":plannow},headers=headers)
    res = res.json()["msg"]
    print(res)
    if res == 'quit':
        break
    else:
        plannow = r.query2bot(plannow, res).replace("[new plan","[plan")
